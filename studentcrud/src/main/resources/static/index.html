<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Management System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; font-family: 'Segoe UI'; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px 0; }
        .student-card { background: white; border-radius: 15px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .course-badge { background-color: #667eea; color: white; padding: 5px 10px; border-radius: 15px; font-size: 12px; }
        .btn-custom { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 10px 20px; border-radius: 25px; }
    </style>
</head>
<body>
<div class="header">
    <div class="container">
        <h1><i class="fas fa-graduation-cap"></i> Student Management System</h1>
        <p>Manage student records with CRUD operations</p>
    </div>
</div>

<div class="container mt-4">
    <!-- Student Form -->
    <div class="card mb-4">
        <div class="card-body">
            <h4><i class="fas fa-user-plus"></i> Add/Edit Student</h4>
            <form id="studentForm">
                <input type="hidden" id="studentId">
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label>Name *</label>
                        <input type="text" class="form-control" id="name" required>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label>Course *</label>
                        <input type="text" class="form-control" id="course" required>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label>Email</label>
                        <input type="email" class="form-control" id="email">
                    </div>
                    <div class="col-md-3 mb-3">
                        <label>Age</label>
                        <input type="number" class="form-control" id="age">
                    </div>
                    <div class="col-md-3 mb-3">
                        <label>Phone</label>
                        <input type="tel" class="form-control" id="phoneNumber">
                    </div>
                </div>
                <button type="submit" class="btn btn-custom">Save Student</button>
                <button type="button" onclick="clearForm()" class="btn btn-secondary">Clear</button>
            </form>
        </div>
    </div>

    <!-- Students List -->
    <h4><i class="fas fa-users"></i> Students List</h4>
    <button onclick="loadStudents()" class="btn btn-outline-primary mb-3">Refresh</button>
    <div id="studentsList">Loading...</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const API_URL = 'http://localhost:8080/students';

    document.addEventListener('DOMContentLoaded', loadStudents);

    document.getElementById('studentForm').addEventListener('submit', function(e) {
        e.preventDefault();
        saveStudent();
    });

    function loadStudents() {
        fetch(API_URL)
            .then(res => res.json())
            .then(students => {
                let html = '<div class="row">';
                students.forEach(student => {
                    html += `
                        <div class="col-md-6">
                            <div class="student-card">
                                <h5>${student.name} <span class="badge bg-primary">${student.age || 'N/A'} yrs</span></h5>
                                <p><span class="course-badge">${student.course}</span></p>
                                ${student.email ? `<p><i class="fas fa-envelope"></i> ${student.email}</p>` : ''}
                                ${student.phoneNumber ? `<p><i class="fas fa-phone"></i> ${student.phoneNumber}</p>` : ''}
                                <div>
                                    <button onclick="editStudent(${student.id})" class="btn btn-sm btn-warning">Edit</button>
                                    <button onclick="deleteStudent(${student.id})" class="btn btn-sm btn-danger">Delete</button>
                                </div>
                            </div>
                        </div>`;
                });
                html += '</div>';
                document.getElementById('studentsList').innerHTML = html;
            });
    }

    function saveStudent() {
        const student = {
            name: document.getElementById('name').value,
            course: document.getElementById('course').value,
            email: document.getElementById('email').value,
            age: document.getElementById('age').value ? parseInt(document.getElementById('age').value) : null,
            phoneNumber: document.getElementById('phoneNumber').value
        };

        const id = document.getElementById('studentId').value;
        const url = id ? `${API_URL}/${id}` : API_URL;
        const method = id ? 'PUT' : 'POST';

        fetch(url, {
            method: method,
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(student)
        }).then(() => {
            loadStudents();
            clearForm();
            alert(id ? 'Student updated!' : 'Student added!');
        });
    }

    function editStudent(id) {
        fetch(`${API_URL}/${id}`)
            .then(res => res.json())
            .then(student => {
                document.getElementById('studentId').value = student.id;
                document.getElementById('name').value = student.name;
                document.getElementById('course').value = student.course;
                document.getElementById('email').value = student.email || '';
                document.getElementById('age').value = student.age || '';
                document.getElementById('phoneNumber').value = student.phoneNumber || '';
            });
    }

    function deleteStudent(id) {
        if(confirm('Delete this student?')) {
            fetch(`${API_URL}/${id}`, {method: 'DELETE'})
                .then(() => loadStudents());
        }
    }

    function clearForm() {
        document.getElementById('studentForm').reset();
        document.getElementById('studentId').value = '';
    }
</script>
</body>
</html>